var rating = function(elementClass, inputId) {
    var faces = ['&#xe6e5;', '&#xe6e5;', '&#xe6e5;', '&#xe6e5;', '&#xe6e5;']
    var ele = document.getElementsByClassName(elementClass);
    var rating = 0,
        maxRating = 0;
    if (ele.length !== 0) {
        rating = ele[0].getAttribute("data-rating");
        maxRating = ele[0].getAttribute("data-max-rating")
    }
    for (var i = 0; i < maxRating; i++) {
        var icon = document.createElement("i");
        var face = document.createElement("div");
        face.className = "face iconfont";
        face.innerHTML = faces[i];
        icon.appendChild(face);
        icon.className = "icon";
        icon.setAttribute("poxs", i);
        if (i < rating) {
            icon.className = "icon active"
        }
        if (!$("." + elementClass).hasClass("disabled")) {
            addRatingListener(icon, elementClass, inputId)
        }
        ele[0].appendChild(icon)
    }
};

function addRatingListener(element, elementClass, inputId) {
    var rate = ["1分 很差", "2分 差", "3分 一般", "4分 满意", "5分 很满意"];
    element.addEventListener("mouseenter", function(event) {
        var starEnd = event.target.getAttribute("poxs");
        var icons = $("." + elementClass + ">i");
        for (var item = 0; item <= starEnd; item++) {
            if (!icons.eq(item).hasClass("selected")) {
                icons.eq(item).addClass("selected")
            }
        }
    });
    element.addEventListener("mouseleave", function(event) {
        var starEnd = event.target.getAttribute("poxs");
        var icons = $("." + elementClass + ">i");
        for (var item = starEnd; item < icons.length; item++) {
            if (icons.eq(item).hasClass("selected")) {
                icons.eq(item).removeClass("selected")
            }
        }
        icons.removeClass("selected")
    });
    element.addEventListener("click", function(event) {
        event.stopPropagation();
        var starEnd = parseInt(event.target.getAttribute("poxs"));
        if (starEnd === null) return;
        var icons = $("." + elementClass + ">i");
        for (var item = 0; item <= starEnd; item++) {
            if (!icons.eq(item).hasClass("active")) {
                icons.eq(item).addClass("active")
            }
        }
        for (var item1 = parseInt(starEnd) + 1; item1 < icons.length; item1++) {
            icons.eq(item1).removeClass("active")
        }
        element.parentNode.parentNode.querySelector('.emphasize-color').innerHTML = rate[starEnd];
        if (document.getElementById(inputId) !== null && document.getElementById(inputId) !== undefined) {
            document.getElementById(inputId).value = starEnd + 1;
        }else {
            console.log('The element ID is not exist OR ID is not the only');
        }

    })
};
